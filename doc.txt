minikube start --memory=8192 --cpus=4
istioctl install -f infrastructure/istio/istio-operator.yaml
kubectl create namespace portfolio
kubectl label namespace portfolio istio-injection=enabled
kubectl apply -f https://raw.githubusercontent.com/istio/istio/release-1.20/samples/addons/prometheus.yaml
kubectl apply -f https://raw.githubusercontent.com/istio/istio/release-1.20/samples/addons/kiali.yaml
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
kubectl apply -n argocd -f infrastructure/argocd/argocd-install.yaml
kubectl apply -f apps/portfolio/deployment.yaml
istioctl dashboard kiali
kubectl port-forward svc/argocd-server -n argocd 8080:443
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | %{[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($_))}


kubectl get pods -n istio-system
kubectl get pods -n argocd
kubectl get pods -n portfolio



# Verificar pods do portfolio
kubectl get pods -n portfolio

# Verificar o gateway
kubectl get gateway -n portfolio

# Verificar virtual service
kubectl get virtualservice -n portfolio


kubectl port-forward svc/argocd-server -n argocd 8080:443